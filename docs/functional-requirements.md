# Функциональные требования
## Общее
0. Отсутствуют ФТ про статистику!
   
I. Для удобства восприятия и документирования система разделена на контексты. Контекст - набор функциональных требований, доступных пользователю в данный момент. Пользователь всегда находится в ровно одном контексте.

II. Если не сказано иного, после завершения функционального сценария, пользователь остаётся в том же контексте, из которого начал функциональный сценарий.

III. Из любого контекста пользователь может вернуться в предыдущий контекст, вплоть до стартового.

IV. Из любого контекста пользователь может выйти из системы.

## Авторизация
1. Я, как гость, в гостевом контексте регистрируюсь в системе, вводя логин, имя и пароль. После чего становлюсь соответствующим участником и перехожу в стартовый контекст.
2. Я, как гость, в гостевом контексте аутентифицируюсь в системе, вводя логин и пароль, соответствующие тем, по которым я ранее зарегистрировался. После чего становлюсь соответствующим участником и перехожу в стартовый контекст.

## Аккаунт
3. Я, как участник, в любом контексте выхожу из аккаунта. После чего становлюсь гостем и перехожу в гостевой контекст.
4. Я, как участник, в стартовом контексте перехожу в контекст управления аккаунтом.
5. Я, как участник, в контексте управления аккаунтом изменяю своё имя.
6. Я, как участник, в контексте управления аккаунтом изменяю свой пароль, введя старый и новый пароли.

## Встраиваемое
7. Я, как участник, в том контексте, в котором указан "поиск участников", ввожу строку и получаю список участников, где для каждого участника указан его логин и имя, причём в списке присутствуют только те участники, в логине или имени каждого из которых присутствует вводная строка в качестве подстроки. Также, если не сказано иного, в этом списке я не присутствую.
8. Я, как участник, в том контексте, в котором указан "выбор участников", через поиск участников получаю список участников и выбираю конкретных участников. Также я могу убрать уже выбранных участников. Таким образом, я могу выбрать практически любое множество участников.

## Привычки
### Ролевая модель
- Наблюдатель привычки видит параметры привычки и отметки по ней.
- Исполнитель привычки может изменять отметки привычки. Также является наблюдателем привычки.
- Редактор привычки может изменять параметры привычки. Также является наблюдателем привычки.
- Менеджер привычки может назначать других пользователей наблюдателями привычки, исполнителями привычки и менеджерами привычки. Также является исполнителем привычки.
- Главред привычки может назначать других участников наблюдателями привычки, редакторами привычки, главредами привычки. Также является редактором привычки.
- Администратор привычки является менеджером привычки и главредом привычки.
  
При изменении роли пользователь получает только одну роль с наибольшим уровнем доступа. В функциональных требованиях указана роль с наименьшим уровнем доступа для конкретного функционального требования.

### Создание привычки
9. Я, как участник, в стартовом контексте перехожу в контекст создания привычки. Если я выйду из этого контекста до подтверждения создания, то никакие введённые данные в этом контексте не сохранятся.
10. Я, как участник, в контексте создания привычки ввожу название привычки, описание, теги, тип отметок, периодичность отметок, цель привычки. Тип отметок, их периодичность и теги я выбираю из предложенных вариантов.
11. Я, как участник, в контексте создания привычки вижу список шаблонов привычек, где для каждого шаблона указано название привычки, описание, теги, тип отметок, периодичность отметок, цель привычки.
12. Я, как участник, в контексте создания привычки выбираю один из шаблонов привычек и создаю свой экземпляр такой привычки, чтобы потом сравнивать свои результаты этой привычки с общими результатами других пользователей по этому шаблону. Этим же действием я подтверждаю создание, перехожу в контекст этой свежесозданной привычки и становлюсь менеджером привычки. Параметры этой привычки равны параметрам шаблона привычки.
13. Я, как участник, в контексте создания привычки выбираю один из шаблонов привычек и копирую её параметры в параметры создаваемой привычки, как если бы я их вводил по одному.
14. Я, как участник, в контексте создания привычки подтверждаю создание с параметрами, которые были введены мною ранее, перехожу в контекст этой свежесозданной привычки и становлюсь администратором привычки. Я могу подтвердить создание, только если корректно введены следующие параметры: название привычки, тип отметок, периодичность отметок, цель привычки.

### Привычка
15. Я, как участник, в стартовом контексте вижу список своих привычек, где для каждой привычки указано название привычки, тип отметок, периодичность отметок, цель привычки.
16. Я, как участник, в стартовом контексте выбираю одну из своих привычек, перехожу в контекст этой привычки и становлюсь администратором этой привычки, если привычка была создана мною самостоятельно, или редактором этой привычки, если привычка является шаблонной.
17. Я, как участник, в стартовом контексте вижу список чужих привычек, но в которых я являюсь наблюдателем привычки или выше, где для каждой привычки указано название привычки, тип отметок, периодичность отметок, цель привычки и её владелец, где для владельца указан его логин и его имя.
18. Я, как участник, в стартовом контексте выбираю одну из чужих привычек, перехожу в контекст этой привычки и становлюсь той максимальной ролью, которой принадлежу в контексте этой привычки.
19. Я, как наблюдатель привычки, в контексте привычки вижу название привычки, описание, теги, тип отметок, периодичность отметок, цель привычки и список отметок, где для каждой отметки указан таймстемп, значение и комментарий.
20. Я, как редактор привычки, в контексте привычки изменяю название привычки, описание и цель привычки. P.S. Нельзя изменить параметры шаблонной привычки: изменять параметры привычки может только редактор, а при создании шаблонной привычки пользователь становится менеджером и не может стать редактором.
21. Я, как менджер привычки, в контексте привычки через выбор участников выбираю участников, которые будут наблюдателями этой привычки, исполнителями этой привычки и менеджерами этой привычки.
22. Я, как главред привычки, в контексте привычки через выбор участников выбираю участников, которые будут наблюдателями этой привычки, редакторами этой привычки и главредами этой привычки.

### Отметки привычки
Список всех таймстемпов привычки - это таймстемпы от момента создания привычки до текущего момента, расположенные с периодичностью, заданной при создании привычки, плюс некоторое количество таймстемпов в будущем, число которых зависит от периодичности. Доступным считается такой таймстемп из этого списка, для которого не существует отметки.

23. Я, как исполнитель привычки, в контексте привычки добавляю отметку к этой привычке, выбрав доступный таймстемп и введя значение и опциональный комментарий. 
24. Я, как исполнитель привычки, в контексте привычки, выбрав конкретную отметку, изменяю её значение, комментарий.

## Группа
### Создание группы
25. Я, как участник, в стартовом контексте перехожу в контекст создания группы. Если я выйду из этого контекста до подтверждения создания, то никакие введённые данные в этом контексте не сохранятся.
26. Я, как участник, в контексте создания группы ввожу её название.
27. Я, как участник, в контексте создания группы через выбор участников выбираю участников, которые после создания группы станут участниками этой группы.
28. Я, как участник, в контексте создания группы подтверждаю её создание с параметрами, которые были введены мною ранее, и перехожу в контекст этой свежесозданной группы и становлюсь участником группы. Я могу подтвердить создание группы, только если я корректно ввёл название.

### Группа
29. Я, как участник, в стартовом контексте вижу список групп, участником которых я явлюсь, причём для каждой группы указано её название.
30. Я, как участник, в стартовом контексте выбираю группу и перехожу в её контекст, становясь участником группы.
31. Я, как участник группы, в контексте группы вижу её название и список участников этой группы.
32. Я, как участник группы, в контексте группы через поиск участников выбираю и добавляю участников, так что они становятся участниками этой группы.
33. Я, как участник группы, в контексте группы выхожу из группы, перестаю быть участником этой группы, становлюсь участником и перехожу в стартовый контекст.

## Встраиваемое
34. Я, как участник группы, в том контексте, в котором указан "поиск участников группы", ввожу строку и получаю список участников группы, где для каждого участника группы указан его логин и имя, причём в списке присутствуют только те участники группы, в логине или имени каждого из которых присутствует вводная строка в качестве подстроки. Также, если не сказано иного, в этом списке я не присутствую.
35. Я, как участник группы, в том контексте, в котором указан "выбор участников группы", через поиск участников группы получаю список участников группы и выбираю конкретных участников группы. Также я могу убрать уже выбранных участников группы. Таким образом, я могу выбрать практически любое множество участников группы.

## Групповые привычки
### Ролевая модель
- Наблюдатель групповой привычки видит параметры групповой привычки и отметки по ней.
- Исполнитель групповой привычки может изменять отметки групповой привычки. Также является наблюдателем групповой привычки.
- Редактор групповой привычки может изменять параметры групповой привычки. Также является наблюдателем групповой привычки.
- Главред групповой привычки может назначать других участников группы редакторами групповой привычки, главредами групповой привычки. Также является редактором групповой привычки.

При изменении роли пользователь получает только одну роль с наибольшим уровнем доступа. В функциональных требованиях указана роль с наименьшим уровнем доступа для конкретного функционального требования.

### Создание групповой привычки
36. Я, как участник группы, в контексте группы перехожу в контекст создания групповой привычки. 

Контекст создания групповой привычки аналогичен контексту создания привычки за следующими исключениями:

37. Я, как участник группы, в контексте создания групповой привычки выбираю один из типов групповой привычки: с общим зачётом или с индивидуальным зачётом.
- При создании шаблонной групповой привычки с общим зачётом я и все остальные участники группы становятся исполнителями этой групповой привычки.
- При создании шаблонной групповой привычки с индивидуальным зачётом на каждого участника группы создаётся шаблонная привычка, где этот участник группы является исполнителем групповой привычки, а все остальные участники группы - наблюдателями групповой привычки.
- При создании не шаблонной групповой привычки с общим зачётом я становлюсь главредом этой групповой привычки, остальные участники группы - исполнителями групповой привычки.
- При создании не шаблонной групповой привычки с индивидуальным зачётом на каждого участника группы создаётся привычка, где этот участник группы является исполнителем этой групповой привычки, я являюсь главредом этой групповой привычки, а остальные участники группы - наблюдателями групповой привычки.

### Групповая привычка
38. Я, как участник группы, в контексте группы вижу список групповых привычек с общим зачётом, где для каждой привычки указано название привычки, тип отметок, периодичность отметок, цель привычки.
39. Я, как участник группы, в контексте группы выбираю групповую привычку с общим зачётом, перехожу в контекст этой групповой привычки с общим зачётом и становлюсь той максимальной ролью, которой являюсь в контексте этой привычки.
40. Я, как участник группы, в контексте группы вижу список групповых привычек с индивидуальным зачётом, где для каждой привычки указано название привычки, тип отметок, периодичность отметок, цель привычки.
41. Я, как участник группы, в контексте группы выбираю групповую привычку с индивидуальным зачётом, перехожу в контекст этой групповой привычки с индивидуальным зачётом и становлюсь той максимальной ролью, которой являюсь в контексте этой привычки.
42. Я, как наблюдатель групповой привычки, в контексте групповой привычки с общим зачётом вижу название привычки, описание, теги, тип отметок, периодичность отметок, цель привычки и список отметок, где для каждой отметки указан таймстемп, значение и комментарий.
43. Я, как наблюдатель групповой привычки, в контексте групповой привычки с индивидуальным зачётом вижу название привычки, описание, теги, тип отметок, периодичность отметок, цель привычки и сводную таблицу, где столбцы озаглавлены таймстемпами отметок, строки - именами и логинами участников группы, обладающих соответствующей привычкей для этой групповой привычки с индивидуальным зачётом, а на пересечении соответствующие отметки, где для каждой отметки указано значение и комментарий.
44. Я, как редактор групповой привычки, в контексте групповой привычки с общим зачётом и в контексте групповой привычки с индивидуальным зачётом изменяю название привычки, описание и цель привычки. 
45. Я, как главред групповой привычки, в контексте групповой привычки с общим зачётом и в контексте групповой привычки с индивидуальным зачётом через выбор участников группы выбираю участников группы, которые будут редакторами этой групповой привычки и главредами этой групповой привычки.

### Отметки групповой привычки
Аналогично отметкам привычки за следующим исключением:
- В контексте групповой привычки с индивидуальным зачётом отметка выставляется только в той строке сводной таблице, которая соответствует мне и моей привычке, в которой я являюсь исполнителем групповой привычки.
